<div class = "custom-bundler__pdp__item">
    <div class = "custom-bundler__pdp__product-card">
      <figure class="card">
        <figcaption class = "title" ><h2>Add a {{product.title}}</h2></figcaption>
  
          <picture class="card__img">
              <source media="(min-width:465px)" srcset="{{ product.featured_image | img_url: 'x650'}}">
              <img src="{{ product.featured_image | img_url: 'x465'}}" alt="{{product.title}}" >        
          </picture>
  
      </figure>
  
      <div class = "variants" data-product_id = "{{product.id}}">
        {% for option in product.options %}
  
            {%capture item_option%}
              <label for="SingleOptionSelector-{{forloop.index0}}" class = "option-label" data-option = "{{option}}">{{ option }} </label>
              <div class="optionSelector" data-index="option{{forloop.index}}">
                {% capture option_index %}option{{ forloop.index }}{% endcapture %} 
                {% assign option_values = product.variants | map: option_index | uniq %}
                {% for choice in option_values %}
                
                {%if option == 'Color'%}
                    <div class = "option-group">
                        <div class = "choice {{option}} {%if forloop.index == 1%}active{%endif%}" data-choice = "{{choice}}" data-choice_type = "{{option}}"></div>
                      <div class = "choice {{option}} image" data-choice = "{{choice}}" data-choice_type = "{{option}}"></div>
                  </div>
                {%else%}
                     <div class = "choice {{option}} {%if forloop.index == 1%}active{%endif%}" data-choice = "{{choice}}" data-choice_type = "{{option}}">{{choice}}</div>
                {%endif%}
                
  
                    {%assign variants_count = forloop.index%}
                    {%if forloop.index == 1 and option == "Color"%}
                        {%assign first_choice_color = choice%}
                    {%elsif forloop.index == 1 and option == "Size"%}
                        {%assign first_choice_size = choice%}
                    {%endif%}
                {% endfor %}
              </div>
            {%endcapture%}
  
            {%if option == "Color"%}
                {{item_option}}
            {%elsif option == "Size" and variants_count > 1%}
                {{item_option}}
            {%elsif option == "Size" and variants_count == 1%}
                <div style = "display:none">
                    {{item_option}}
                </div>
            {%endif%}
        {% endfor %}
  
        <div class = "combined-options" data-comb_options = "{{first_choice_color}} / {{first_choice_size}}" ></div>
  
        <div class = "all-variants" data-productid="{{product.id}}">
          {% for option in product.variants %}
              <div data-value="{{option.id}}" data-title="{{option.title}}" data-img="{{option.image.src | img_url: 'x600'}}" data-quantity="{{option.inventory_quantity}}"> </div>
            {%if forloop.index == 1%}
                {%assign default_variant_id = option.id %}
            {%endif%}
          {% endfor %}
        </div>
  
        <div class = "selected-variant-id" data-variant_id="{{default_variant_id}}">
        </div>
  
      </div><!-- variants-->
    </div>
    <div style = "display:none">
      <div class ="custom-bundler__pdp__your-selection product-id-{{product.id}}">
        <picture class="card__img">
          <img src="{{ product.featured_image | img_url: 'x465'}}" alt="{{product.title}}" >        
        </picture>  
      </div>
    </div>
  </div>
  
  